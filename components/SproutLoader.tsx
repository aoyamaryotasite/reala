import React from "react";

/** SproutLoader + Cursive "Reala" draw animation (no Tailwind) */
export default function SproutLoader({
  size = 120,
  primary = "#111111",      // ペン色 & テキスト色
  secondary = "#285f65",    // 芽の色
  duration = 1.8,           // 芽アニメ周期
  className = "",
  label = "Loading",
  showWord = true,          // “Reala” を表示する/しない
  wordDelayMs = 600,        // 芽の後、何ms 後に書き始めるか
}: {
  size?: number;
  primary?: string;
  secondary?: string;
  duration?: number;
  className?: string;
  label?: string;
  showWord?: boolean;
  wordDelayMs?: number;
}) {
  const s = size;

  return (
    <div
      className={className}
      role="status"
      aria-label={label}
      style={{
        width: s,
        height: s + (showWord ? 44 : 0), // 文字ぶん高さ
        display: "inline-flex",
        flexDirection: "column",
        alignItems: "center",
        justifyContent: "center",
      }}
    >
      {/* ===== アイコン（芽＋ペン） ===== */}
      <svg
        width={s}
        height={s}
        viewBox="0 0 100 100"
        xmlns="http://www.w3.org/2000/svg"
        aria-hidden="true"
        style={
          {
            ["--sprout-primary" as any]: primary,
            ["--sprout-secondary" as any]: secondary,
            ["--sprout-duration" as any]: `${duration}s`,
          } as React.CSSProperties
        }
      >
        <g className="sprout-bob">
          {/* ペン先（下向き） */}
          <g transform="translate(50,72) rotate(180)">
            <rect x="-9" y="26" width="18" height="5" rx="1.5" fill="var(--sprout-primary)" opacity="0.9" />
            <path d="M 0,-26 L 14,10 Q 0,16 0,32 Q 0,16 -14,10 Z" fill="var(--sprout-primary)" />
            <circle cx="0" cy="6.5" r="2.2" fill="#fff" className="breather" />
            <rect x="-0.75" y="18" width="1.5" height="12" rx="1" fill="#fff" />
          </g>

          {/* 芽（位置は translate のYで上下） */}
          <g transform="translate(50,22)">
            <path
              className="stem"
              d="M0,36 C 0,22 0,10 0,0"
              fill="none"
              stroke="var(--sprout-secondary)"
              strokeWidth="3.6"
              strokeLinecap="round"
            />
            <path
              className="leaf leaf-left"
              d="M 0,0 C -10,-2 -25,-7 -34,-12 C -22,-12 -8,-7 0,0 Z"
              fill="var(--sprout-secondary)"
            />
            <path
              className="leaf leaf-right"
              d="M 0,0 C 10,-2 25,-7 34,-12 C 22,-12 8,-7 0,0 Z"
              fill="var(--sprout-secondary)"
            />
          </g>
        </g>

        <style>{`
          .sprout-bob { animation: bob var(--sprout-duration) ease-in-out infinite; transform-origin: 50% 70%; }
          @keyframes bob { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-2px); } }

          .stem { stroke-dasharray: 40; stroke-dashoffset: 40; animation: draw var(--sprout-duration) cubic-bezier(.3,.7,.3,1) infinite; }
          @keyframes draw { 0% { stroke-dashoffset: 40; } 48% { stroke-dashoffset: 0; } 100% { stroke-dashoffset: 0; } }

          .leaf { opacity: 0; transform-origin: 0 0; }
          .leaf-left  { animation: leafInLeft  var(--sprout-duration) ease-out infinite; }
          .leaf-right { animation: leafInRight var(--sprout-duration) ease-out infinite; }
          @keyframes leafInLeft  { 0% {opacity:0; transform:scale(.85) rotate(-7deg);} 42% {opacity:0;} 62% {opacity:1; transform:scale(1) rotate(0);} 85% {transform:scale(1.02) rotate(-3deg);} 100% {transform:scale(1) rotate(0);} }
          @keyframes leafInRight { 0% {opacity:0; transform:scale(.85) rotate(7deg);}  42% {opacity:0;} 62% {opacity:1; transform:scale(1) rotate(0);} 85% {transform:scale(1.02) rotate(3deg);}  100% {transform:scale(1) rotate(0);} }

          .breather { animation: blink calc(var(--sprout-duration)/1.2) ease-in-out infinite; }
          @keyframes blink { 0%,100% {opacity:.95;} 50% {opacity:.4;} }
        `}</style>
      </svg>

      {/* ===== “Reala” 筆記体（手書きアニメ） ===== */}
      {showWord && (
        <svg
          width={s * 0.9}
          height="60"
          viewBox="0 0 177 60"
          xmlns="http://www.w3.org/2000/svg"
          style={{ marginTop: 8 }}
        >
          <defs>
            {/* 1) Figmaの塗りパス */}
            <path id="realaFillPath" d="M8.696 59.864C5.432 59.864 3.256 59.32 2.168 58.232C1.08 57.144 0.536 56.024 0.536 54.872C0.536 53.784 0.92 52.984 1.688 52.472C2.392 51.96 3.096 51.704 3.8 51.704C5.144 51.704 5.816 52.28 5.816 53.432C5.816 53.944 5.624 54.392 5.24 54.776C4.792 55.096 4.248 55.256 3.608 55.256C3.16 55.256 2.776 55.192 2.456 55.064C2.136 54.936 1.976 54.872 1.976 54.872C1.976 55.704 2.36 56.568 3.128 57.464C3.832 58.36 5.368 58.808 7.736 58.808C10.36 58.808 12.76 58.104 14.936 56.696C17.112 55.224 19.192 53.304 21.176 50.936C23.224 48.504 25.304 45.848 27.416 42.968C29.528 40.024 31.8 37.08 34.232 34.136C35.96 32.088 37.976 29.752 40.28 27.128C42.648 24.504 45.24 21.944 48.056 19.448C50.936 16.888 53.976 14.648 57.176 12.728C60.376 10.744 63.704 9.4 67.16 8.696C68.056 8.504 68.504 8.568 68.504 8.888C68.504 9.208 68.056 9.464 67.16 9.656C64.28 10.296 61.464 11.672 58.712 13.784C55.96 15.896 53.208 18.488 50.456 21.56C47.768 24.568 45.08 27.8 42.392 31.256C39.704 34.712 37.016 38.136 34.328 41.528C31.64 44.92 28.888 47.992 26.072 50.744C23.32 53.496 20.504 55.704 17.624 57.368C14.744 59.032 11.768 59.864 8.696 59.864ZM45.752 59.864C43 59.864 41.176 59.352 40.28 58.328C39.448 57.24 39.032 56.056 39.032 54.776C39.032 52.6 39.512 50.712 40.472 49.112C41.432 47.512 42.52 46.104 43.736 44.888C44.952 43.672 46.04 42.52 47 41.432C47.96 40.344 48.44 39.256 48.44 38.168C48.44 37.272 48.024 36.664 47.192 36.344C46.36 36.024 45.56 35.864 44.792 35.864C44.28 35.864 43.832 35.896 43.448 35.96C43.128 36.024 42.968 36.12 42.968 36.248C42.968 36.504 43.128 36.696 43.448 36.824C43.832 36.888 44.248 36.92 44.696 36.92C46.744 36.92 48.76 36.344 50.744 35.192C52.792 33.976 54.648 32.44 56.312 30.584C57.976 28.664 59.32 26.648 60.344 24.536C61.368 22.424 61.88 20.472 61.88 18.68C61.88 15.864 60.472 13.592 57.656 11.864C54.84 10.072 50.456 9.17599 44.504 9.17599C40.216 9.17599 36.184 9.88 32.408 11.288C28.632 12.632 25.336 14.424 22.52 16.664C19.704 18.84 17.496 21.176 15.896 23.672C14.296 26.104 13.496 28.376 13.496 30.488C13.496 32.024 13.976 33.368 14.936 34.52C15.896 35.672 17.336 36.248 19.256 36.248C21.304 36.248 23.384 35.512 25.496 34.04C27.672 32.568 29.688 30.744 31.544 28.568C33.464 26.328 35.064 23.992 36.344 21.56C37.624 19.128 38.424 16.952 38.744 15.032C38.872 14.456 39.064 14.168 39.32 14.168C39.576 14.168 39.704 14.456 39.704 15.032C39.704 18.104 39.128 20.984 37.976 23.672C36.824 26.36 35.288 28.728 33.368 30.776C31.448 32.76 29.304 34.328 26.936 35.48C24.632 36.632 22.264 37.208 19.832 37.208C17.4 37.208 15.512 36.568 14.168 35.288C12.888 34.008 12.248 32.216 12.248 29.912C12.248 27.8 13.08 25.496 14.744 23C16.408 20.504 18.744 18.136 21.752 15.896C24.824 13.592 28.408 11.736 32.504 10.328C36.664 8.856 41.208 8.12 46.136 8.12C49.592 8.12 52.76 8.632 55.64 9.656C58.52 10.68 60.824 12.216 62.552 14.264C64.344 16.312 65.24 18.904 65.24 22.04C65.24 24.088 64.568 26.072 63.224 27.992C61.944 29.848 60.28 31.512 58.232 32.984C56.184 34.456 54.008 35.608 51.704 36.44C49.4 37.272 47.224 37.688 45.176 37.688C43.896 37.688 42.968 37.592 42.392 37.4C41.88 37.144 41.624 36.792 41.624 36.344C41.624 36.024 41.848 35.736 42.296 35.48C42.808 35.224 43.736 35.096 45.08 35.096C45.848 35.096 46.712 35.224 47.672 35.48C48.632 35.672 49.464 36.12 50.168 36.824C50.936 37.528 51.32 38.616 51.32 40.088C51.32 42.072 50.808 43.864 49.784 45.464C48.824 47.064 47.704 48.504 46.424 49.784C45.144 51 43.992 52.152 42.968 53.24C42.008 54.264 41.528 55.288 41.528 56.312C41.528 57.208 41.848 57.848 42.488 58.232C43.192 58.616 44.056 58.808 45.08 58.808C46.936 58.808 48.792 58.296 50.648 57.272C52.568 56.184 54.36 54.776 56.024 53.048C57.688 51.32 59.064 49.464 60.152 47.48C61.304 45.496 62.008 43.544 62.264 41.624C62.392 40.92 62.584 40.664 62.84 40.856C63.16 41.048 63.352 41.464 63.416 42.104C63.672 43.64 63.256 45.432 62.168 47.48C61.144 49.464 59.704 51.416 57.848 53.336C56.056 55.192 54.072 56.76 51.896 58.04C49.784 59.256 47.736 59.864 45.752 59.864ZM72.2308 59.864C69.2228 59.864 67.2387 59.192 66.2787 57.848C65.3187 56.44 64.8387 54.968 64.8387 53.432C64.8387 50.808 65.5107 48.376 66.8547 46.136C68.1987 43.832 69.9268 41.784 72.0388 39.992C74.1508 38.2 76.3268 36.824 78.5668 35.864C80.8708 34.84 82.9188 34.328 84.7108 34.328C85.9908 34.328 87.0148 34.52 87.7828 34.904C88.5508 35.224 88.9348 35.928 88.9348 37.016C88.9348 38.04 88.3268 39.128 87.1108 40.28C85.8948 41.432 84.3588 42.552 82.5028 43.64C80.6468 44.664 78.6948 45.624 76.6468 46.52C74.6628 47.352 72.8388 48.024 71.1748 48.536C69.5108 49.048 68.2948 49.304 67.5267 49.304C67.5267 49.304 67.5267 49.144 67.5267 48.824C67.5267 48.44 67.5267 48.248 67.5267 48.248C68.1028 48.312 69.0948 48.12 70.5028 47.672C71.9748 47.224 73.6068 46.648 75.3988 45.944C77.1908 45.176 78.9188 44.312 80.5828 43.352C82.3108 42.392 83.7188 41.368 84.8068 40.28C85.9588 39.192 86.5348 38.136 86.5348 37.112C86.5348 36.6 86.3748 36.152 86.0548 35.768C85.7988 35.384 85.3188 35.192 84.6148 35.192C83.5908 35.192 82.3428 35.704 80.8708 36.728C79.4628 37.688 78.0228 38.968 76.5508 40.568C75.0788 42.168 73.7028 43.864 72.4228 45.656C71.1428 47.448 70.0868 49.176 69.2548 50.84C68.4868 52.44 68.1028 53.784 68.1028 54.872C68.1028 56.152 68.4868 57.112 69.2548 57.752C70.0228 58.392 71.1428 58.712 72.6148 58.712C75.1748 58.712 77.5748 58.104 79.8148 56.888C82.1188 55.608 84.1988 54.136 86.0548 52.472C87.9108 50.744 89.4788 49.144 90.7588 47.672C92.0388 46.136 92.9028 45.144 93.3508 44.696C93.3508 44.696 93.4468 44.792 93.6388 44.984C93.8948 45.176 94.0228 45.272 94.0228 45.272C93.5748 45.784 92.7108 46.808 91.4308 48.344C90.1508 49.88 88.5508 51.544 86.6308 53.336C84.7108 55.128 82.5348 56.664 80.1028 57.944C77.6708 59.224 75.0468 59.864 72.2308 59.864ZM114.053 42.2C113.797 42.712 113.413 43.16 112.901 43.544C112.453 43.928 112.101 44.184 111.845 44.312C111.653 44.376 111.717 44.184 112.037 43.736C113.189 42.328 113.925 41.016 114.245 39.8C114.629 38.584 114.629 37.624 114.245 36.92C113.925 36.152 113.285 35.768 112.325 35.768C111.045 35.768 109.541 36.28 107.813 37.304C106.085 38.328 104.293 39.672 102.437 41.336C100.645 43 98.949 44.792 97.349 46.712C95.813 48.568 94.565 50.392 93.605 52.184C92.645 53.912 92.165 55.416 92.165 56.696C92.165 57.656 92.357 58.264 92.741 58.52C93.125 58.776 93.509 58.904 93.893 58.904C95.365 58.904 97.061 58.232 98.981 56.888C100.965 55.48 102.981 53.72 105.029 51.608C107.077 49.496 109.029 47.352 110.885 45.176C112.741 42.936 114.341 40.92 115.685 39.128C117.093 37.336 118.053 36.12 118.565 35.48C119.269 35.736 120.101 35.832 121.061 35.768C122.085 35.704 122.949 35.64 123.653 35.576C123.525 35.768 122.853 36.568 121.637 37.976C120.485 39.384 119.077 41.08 117.413 43.064C115.813 44.984 114.181 46.968 112.517 49.016C110.917 51.064 109.573 52.856 108.485 54.392C107.397 55.928 106.853 56.952 106.853 57.464C106.853 58.104 106.981 58.52 107.237 58.712C107.557 58.84 108.037 58.904 108.677 58.904C109.445 58.84 110.565 58.488 112.037 57.848C113.509 57.144 115.397 55.8 117.701 53.816C120.005 51.832 122.789 48.888 126.053 44.984C126.053 44.984 126.181 45.08 126.437 45.272C126.757 45.464 126.917 45.56 126.917 45.56C123.077 50.04 119.525 53.56 116.261 56.12C112.997 58.616 110.021 59.864 107.333 59.864C105.925 59.864 104.965 59.64 104.453 59.192C104.005 58.744 103.781 58.104 103.781 57.272C103.781 56.632 104.037 55.864 104.549 54.968C105.125 54.008 105.765 53.08 106.469 52.184C107.173 51.288 107.749 50.584 108.197 50.072C108.197 50.072 108.133 50.04 108.005 49.976C107.877 49.912 107.813 49.88 107.813 49.88C106.341 51.672 104.773 53.336 103.109 54.872C101.445 56.408 99.781 57.624 98.117 58.52C96.517 59.416 94.949 59.864 93.413 59.864C91.813 59.864 90.693 59.48 90.053 58.712C89.413 57.88 89.093 56.632 89.093 54.968C89.093 53.368 89.605 51.448 90.629 49.208C91.653 46.904 93.125 44.664 95.045 42.488C96.965 40.248 99.269 38.392 101.957 36.92C104.709 35.448 107.781 34.712 111.173 34.712C112.837 34.712 113.989 35.032 114.629 35.672C115.269 36.248 115.557 36.952 115.493 37.784C115.429 38.616 115.237 39.448 114.917 40.28C114.597 41.112 114.309 41.752 114.053 42.2ZM156.751 0.823999C157.455 0.951998 158.319 1.016 159.343 1.016C160.431 1.016 161.295 0.951998 161.935 0.823999L128.527 47.384C127.503 48.92 126.511 50.36 125.551 51.704C124.591 53.048 123.823 54.232 123.247 55.256C122.607 56.216 122.287 56.984 122.287 57.56C122.287 58.008 122.479 58.328 122.863 58.52C123.183 58.712 123.663 58.808 124.303 58.808C125.775 58.808 127.407 58.296 129.199 57.272C130.991 56.184 132.751 54.84 134.479 53.24C136.271 51.64 137.903 50.072 139.375 48.536C140.911 47 142.127 45.752 143.023 44.792L143.695 45.368C142.863 46.264 141.711 47.512 140.239 49.112C138.767 50.712 137.071 52.344 135.151 54.008C133.295 55.608 131.343 56.984 129.295 58.136C127.311 59.288 125.359 59.864 123.439 59.864C122.415 59.864 121.551 59.576 120.847 59C120.079 58.424 119.695 57.592 119.695 56.504C119.695 55.8 119.951 54.904 120.463 53.816C120.975 52.728 121.615 51.608 122.383 50.456C123.087 49.24 123.791 48.152 124.495 47.192C125.135 46.168 125.647 45.4 126.031 44.888L156.751 0.823999ZM163.834 42.2C163.578 42.712 163.194 43.16 162.682 43.544C162.234 43.928 161.882 44.184 161.626 44.312C161.434 44.376 161.498 44.184 161.818 43.736C162.97 42.328 163.706 41.016 164.026 39.8C164.41 38.584 164.41 37.624 164.026 36.92C163.706 36.152 163.066 35.768 162.106 35.768C160.826 35.768 159.322 36.28 157.594 37.304C155.866 38.328 154.074 39.672 152.218 41.336C150.426 43 148.73 44.792 147.13 46.712C145.594 48.568 144.346 50.392 143.386 52.184C142.426 53.912 141.946 55.416 141.946 56.696C141.946 57.656 142.138 58.264 142.522 58.52C142.906 58.776 143.29 58.904 143.674 58.904C145.146 58.904 146.842 58.232 148.762 56.888C150.746 55.48 152.762 53.72 154.81 51.608C156.858 49.496 158.81 47.352 160.666 45.176C162.522 42.936 164.122 40.92 165.466 39.128C166.874 37.336 167.834 36.12 168.346 35.48C169.05 35.736 169.882 35.832 170.842 35.768C171.866 35.704 172.73 35.64 173.434 35.576C173.306 35.768 172.634 36.568 171.418 37.976C170.266 39.384 168.858 41.08 167.194 43.064C165.594 44.984 163.962 46.968 162.298 49.016C160.698 51.064 159.354 52.856 158.266 54.392C157.178 55.928 156.634 56.952 156.634 57.464C156.634 58.104 156.762 58.52 157.018 58.712C157.338 58.84 157.818 58.904 158.458 58.904C159.226 58.84 160.346 58.488 161.818 57.848C163.29 57.144 165.178 55.8 167.482 53.816C169.786 51.832 172.57 48.888 175.834 44.984C175.834 44.984 175.962 45.08 176.218 45.272C176.538 45.464 176.698 45.56 176.698 45.56C172.858 50.04 169.306 53.56 166.042 56.12C162.778 58.616 159.802 59.864 157.114 59.864C155.706 59.864 154.746 59.64 154.234 59.192C153.786 58.744 153.562 58.104 153.562 57.272C153.562 56.632 153.818 55.864 154.33 54.968C154.906 54.008 155.546 53.08 156.25 52.184C156.954 51.288 157.53 50.584 157.978 50.072C157.978 50.072 157.914 50.04 157.786 49.976C157.658 49.912 157.594 49.88 157.594 49.88C156.122 51.672 154.554 53.336 152.89 54.872C151.226 56.408 149.562 57.624 147.898 58.52C146.298 59.416 144.73 59.864 143.194 59.864C141.594 59.864 140.474 59.48 139.834 58.712C139.194 57.88 138.874 56.632 138.874 54.968C138.874 53.368 139.386 51.448 140.41 49.208C141.434 46.904 142.906 44.664 144.826 42.488C146.746 40.248 149.05 38.392 151.738 36.92C154.49 35.448 157.562 34.712 160.954 34.712C162.618 34.712 163.77 35.032 164.41 35.672C165.05 36.248 165.338 36.952 165.274 37.784C165.21 38.616 165.018 39.448 164.698 40.28C164.378 41.112 164.09 41.752 163.834 42.2Z" />
   </defs>

    {/* ① 線でなぞる */}
    <use
      href="#realaFillPath"
      fill="none"
      stroke={primary}
      strokeWidth="1.6"
      strokeLinecap="round"
      strokeLinejoin="round"
      pathLength={1}
      strokeDasharray={1}
      strokeDashoffset={1}
      className="reala-stroke"
      style={{ vectorEffect: "non-scaling-stroke" }}
    />

    {/* ② 塗りをあとから表示（フェードイン） */}
    <use
      href="#realaFillPath"
      fill={primary}
      className="reala-fill"
    />

    <style>{`
      .reala-stroke{
        animation: realaWrite 1800ms ease forwards;
        animation-delay: ${wordDelayMs}ms;
      }
      .reala-fill{
        opacity: 0;
        animation: realaFillIn 300ms ease forwards;
        animation-delay: ${wordDelayMs + 1800}ms;
      }
      @keyframes realaWrite { to { stroke-dashoffset: 0; } }
      @keyframes realaFillIn { to { opacity: 1; } }
    `}</style>
  </svg>
      )}
    </div>
  );
}
